# TODO

Current phase tasks.

## Repo Refactoring (ACTIVE)

Single source architecture: `src/` → `dist/` → CDN/npm

### Build Setup

- [x] Add esbuild as dev dependency
- [x] Add `npm run build` script (src/ → dist/)
- [x] Add `npm run dev` script (serve demo/)
- [x] Create dist/ folder structure

### Package Config

- [x] Update package.json with exports field
- [x] Add "main" and "module" fields
- [x] Configure for npm publish
- [x] Add .npmignore (exclude demo/, doc/)

### Demo Refactor

- [x] Update demo/index.html to import from dist/
- [x] Test demo with built dist/

### Docs Site Refactor

Konverter /docs til single-source arkitektur som /demo.
Målgruppe: lægfolk 12-13 år og derover.

#### Teknisk migration

- [ ] Fjern docs/js/wrapper.js (duplikat)
- [ ] Fjern docs/js/tref.min.js (duplikat)
- [ ] Opret docs/js/browser.js som importerer fra CDN
- [ ] Opdater index.html til at importere fra CDN
- [ ] Opdater builder.html til at importere fra CDN
- [ ] Opdater guide.html til at importere fra CDN
- [ ] Opdater about-cli.html til at importere fra CDN
- [ ] Opdater examples.html til at importere fra CDN
- [ ] Opdater examples/drag-drop.html til at importere fra CDN
- [ ] Opdater examples/ai-chat.html til at importere fra CDN
- [ ] Tilføj theme toggle til alle sider (som demo/)
- [ ] Test alle sider lokalt
- [ ] Test med tref.lpmwfx.com

#### Indhold til målgruppe (12-13 år)

- [ ] Omskriv index.html med enkle analogier (som about-cli.html)
- [ ] Fjern teknisk jargon fra forsiden (SHA-256, content-addressed)
- [ ] Tilføj "faktakort" og "fingeraftryk" analogier
- [ ] Forenkl use cases til konkrete eksempler
- [ ] Mærk guide.html tydeligt som "For udviklere"
- [ ] Gennemgå builder.html for klarhed

### Documentation

- [x] Document architecture in doc/project.md
- [x] Update CLAUDE.md with build workflow
- [ ] Add CONTRIBUTING.md with dev setup

---

## Wrapper UX Adaptation

Align `src/wrapper/wrapper.js` with `doc/TrefBlockUIUX.md` specification.
Test in `/demo` folder. Goal: wrapper.js as reusable library.

### Typedef

- [x] Rename `AIBlock` to `TrefBlock` throughout

### Accessibility

- [x] Add `role="button"` to icon
- [x] Add `aria-label` to icon and action buttons
- [x] Add `tabindex="0"` to icon for keyboard focus
- [x] Fix focus styles (`:focus-visible` instead of removing outline)
- [x] Add keyboard handlers (Enter/Space to activate)

### Mobile / Touch

- [x] Add tap-to-toggle for action menu on touch devices
- [x] Add long-press (500ms) to start drag
- [x] Add responsive sizing (32px → 48px on mobile)
- [x] Add `@media (pointer: coarse)` styles for touch hit areas

### Compact Receiver

- [x] Add `.tref-receiver-compact` class (32x32)
- [x] Add `compact: true` option to TrefReceiver
- [x] Keep large mode for standalone drop zones

### Demo Page

- [x] Create `/demo/wrapper-test.html` for visual testing
- [ ] Test all states: hover, focus, active, drag, drop
- [ ] Test accessibility with keyboard only
- [ ] Test on mobile/touch device

### Screen Reader

- [ ] Add live region for status announcements
- [ ] Announce copy success/failure
- [ ] Announce drop success/failure

### Theme Support (Light/Dark/Custom)

- [x] Convert hardcoded colors to CSS custom properties
- [x] Add `@media (prefers-color-scheme: dark)` styles
- [x] Document custom theme override pattern
- [x] Test in light and dark contexts

### UI/UX Build Guide

- [ ] Add `/doc/TrefBlockUIUX.md` to docs site (tref.lpmwfx.com)
- [ ] Create visual examples in `/docs/ui-guide/`
- [ ] Add interactive component demos
- [ ] Include copy-paste code snippets
- [ ] Document all CSS classes with visual examples
- [ ] Show correct vs incorrect implementations
